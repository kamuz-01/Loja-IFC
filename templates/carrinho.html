{% extends "base.html" %}

{% block title %}Carrinho de compras{% endblock %}

{% block content %}
  <h1 class="text-center mb-4">Carrinho de Compras</h1>

  {% if carrinho|length > 0 %}
    <div class="table-responsive mb-4">
      <table class="table table-bordered table-striped align-middle text-center">
        <thead class="table-success">
          <tr>
            <th>Produto</th>
            <th style="width: 160px;">Quantidade</th>
            <th>Preço unitário</th>
            <th>Preço total</th>
            <th>Ação</th>
          </tr>
        </thead>
        <tbody>
          {% for item in carrinho %}
            {% with produto=item.produto %}
              <tr>
                <td>{{ produto.nome }}</td>
                
                <td>
                  <div class="d-flex justify-content-center align-items-center gap-2">
                    <!-- Botão - -->
                    <a href="{% url 'remover_uma_unidade' produto.id %}" class="btn btn-outline-danger btn-sm" title="Remover">
                      <i class="fas fa-minus"></i>
                    </a>
                    <span class="fw-bold">{{ item.quantidade }}</span>
                    <!-- Botão + -->
                    <a href="{% url 'adicionar_ao_carrinho' produto.id %}" class="btn btn-outline-success btn-sm" title="Adicionar">
                      <i class="fas fa-plus"></i>
                    </a>
                  </div>
                </td>

                <td>R$ {{ item.preco }}</td>
                <td>R$ {{ item.preco_total }}</td>
                <td>
                  <a href="{% url 'remover_do_carrinho' produto.id %}" class="btn btn-danger btn-sm">
                    Remover tudo
                  </a>
                </td>
              </tr>
            {% endwith %}
          {% endfor %}

          <tr class="fw-bold table-secondary">
            <td colspan="3" class="text-end">Total:</td>
            <td>R$ {{ carrinho.get_total_preco }}</td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-center gap-3 mb-5">
      <a href="{% url 'lista_produtos' %}" class="btn btn-secondary">Continuar comprando</a>
      <a href="{% url 'checkout' %}" class="btn btn-primary">Finalizar compra</a>
    </div>

  {% else %}
    <div class="text-center text-muted fs-5">
      <p>Seu carrinho está vazio!</p>
      <a href="{% url 'lista_produtos' %}" class="fw-bold text-primary text-decoration-none">
        Voltar à lista de produtos
      </a>
    </div>
  {% endif %}
{% endblock %}